<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeoGriego - Pedido de Yogurt Artesanal Premium</title>
    <link rel="icon" href="logo.png" type="image/x-icon">
    
    <!-- Google Fonts: Poppins & Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <style>
        /* ----------------------------------------------------------------------
        VARIABLES DE BRANDING PREMIUM - INSPIRADO EN PRODUCTOS ARTESANALES GRIEGOS
        ----------------------------------------------------------------------
        */
        :root {
            --primary-color: #2563eb; /* Azul mediterráneo profundo */
            --primary-light: #3b82f6;
            --secondary-color: #0ea5e9; /* Azul cielo mediterráneo */
            --accent-color: #f59e0b; /* Dorado griego cálido */
            --accent-light: #fbbf24;
            
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            
            --neutral-50: #f8fafc;
            --neutral-100: #f1f5f9;
            --neutral-200: #e2e8f0;
            --neutral-300: #cbd5e1;
            --neutral-400: #94a3b8;
            --neutral-500: #64748b;
            --neutral-600: #475569;
            --neutral-700: #334155;
            --neutral-800: #1e293b;
            --neutral-900: #0f172a;

            --gradient-primary: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-light) 100%);
            --gradient-background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            
            --font-display: 'Poppins', sans-serif;
            --font-body: 'Inter', sans-serif;
            
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
        }

        /* Reset y configuración base */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            background: var(--gradient-background);
            color: var(--neutral-800);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            position: relative;
            overflow-x: hidden;
        }

        /* Elementos decorativos de fondo */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 25% 25%, rgba(37, 99, 235, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 75% 75%, rgba(14, 165, 233, 0.03) 0%, transparent 50%);
            z-index: -1;
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-20px, -20px) rotate(1deg); }
        }

        /* Contenedor principal con glassmorphism */
        .container {
            width: 100%;
            max-width: 480px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            box-shadow: var(--shadow-2xl);
            padding: 2.5rem;
            position: relative;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Header con estilo premium */
        .form-header {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }

        .logo-container {
            position: relative;
            display: inline-block;
            margin-bottom: 1.5rem;
        }

        .logo-placeholder {
            width: 90px;
            height: 90px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.2rem;
            font-weight: 700;
            color: white;
            font-family: var(--font-display);
            box-shadow: var(--shadow-lg);
            position: relative;
            z-index: 2;
            animation: pulse 2s ease-in-out infinite;
        }
        
        /* ----------------------------------------------------------------------
        INSTRUCCIÓN DE BRANDING:
        - Reemplace este div con: <img src="URL_DE_SU_LOGO.png" alt="Logo LeoGriego" style="width: 90px; height: 90px; border-radius: 50%; object-fit: cover; box-shadow: var(--shadow-lg);">
        ----------------------------------------------------------------------
        */

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-container::after {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: var(--gradient-accent);
            border-radius: 50%;
            z-index: 1;
            opacity: 0.2;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .form-header h1 {
            font-family: var(--font-display);
            font-size: 2.25rem;
            font-weight: 700;
            background: var(--gradient-primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .form-header .subtitle {
            font-size: 1.1rem;
            color: var(--neutral-600);
            font-weight: 500;
        }

        /* Estilos del formulario modernos */
        .order-form {
            position: relative;
        }

        .form-group {
            margin-bottom: 1.75rem;
            position: relative;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--neutral-700);
            margin-bottom: 0.75rem;
            font-family: var(--font-display);
            letter-spacing: 0.01em;
        }

        .input-wrapper {
            position: relative;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--neutral-200);
            border-radius: 16px;
            font-size: 1rem;
            font-family: var(--font-body);
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
            transform: translateY(-1px);
        }

        .form-group input:hover,
        .form-group select:hover {
            border-color: var(--neutral-300);
            box-shadow: var(--shadow-sm);
        }

        /* Select personalizado */
        .form-group select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 1rem center;
            background-repeat: no-repeat;
            background-size: 1.25rem;
            padding-right: 3rem;
        }

        /* Tarjeta de precio total con animación */
        .total-price {
            background: var(--gradient-accent);
            border-radius: 20px;
            padding: 1.5rem;
            margin: 2rem 0;
            text-align: center;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            animation: totalPulse 0.5s ease-out;
        }
        
        @keyframes totalPulse {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .total-price::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .total-price .amount {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 0.25rem;
        }
        
        /* Botón de envío premium */
        .submit-btn {
            width: 100%;
            padding: 1.25rem 2rem;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            font-family: var(--font-display);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .submit-btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-lg);
        }

        .submit-btn:disabled {
            background: var(--neutral-400);
            cursor: not-allowed;
            transform: none;
            box-shadow: var(--shadow-sm);
        }

        .submit-btn:disabled::before {
            display: none;
        }

        /* Estados de carga */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mensajes de estado mejorados */
        .status-message {
            text-align: center;
            padding: 1rem 1.5rem;
            margin-top: 1.5rem;
            border-radius: 12px;
            font-weight: 500;
            display: none;
            position: relative;
            overflow: hidden;
        }

        .status-message.success {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            color: #065f46;
            border: 1px solid #10b981;
        }

        .status-message.error {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        .status-message.show {
            display: block;
            animation: messageSlide 0.5s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Nota de anticipación estilizada */
        .form-note {
            text-align: center;
            font-size: 0.9rem;
            color: var(--neutral-500);
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(37, 99, 235, 0.05);
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            font-style: italic;
        }
        
        /* Responsive design */
        @media (max-width: 480px) {
            .container {
                padding: 2rem 1.5rem;
                margin: 0.5rem;
                border-radius: 20px;
            }

            .form-header h1 {
                font-size: 2rem;
            }

            .logo-placeholder {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }
            
            .form-group input,
            .form-group select {
                padding: 0.875rem 1rem;
            }

            .submit-btn {
                padding: 1rem 1.5rem;
            }
        }
    </style>
</head>
<body>

    <main class="container">
        <header class="form-header">
            <div class="logo-container">
                <img src="logo.png" class="logo-placeholder" alt="yogurt griego con arandanos, menta y miel">
            </div>
            <h1>LeoGriego</h1>
            <p class="subtitle">Yogurt Griego Artesanal</p>
        </header>

        <form id="orderForm" class="order-form">
            <div class="form-group">
                <label for="nombreCliente">Nombre del cliente</label>
                <input type="text" id="nombreCliente" name="Nombre" required>
            </div>

            <div class="form-group">
                <label for="telefono">Teléfono</label>
                <input type="tel" id="telefono" name="Telefono" required>
            </div>

            <div class="form-group">
                <label for="producto">Productos</label>
                <select id="producto" name="Producto" required>
                    <option value="Yogurt griego artesanal 1 Kg">Yogurt griego artesanal 1 Kg</option>
                    <!-- 
                    ----------------------------------------------------------------------
                    OPCIONES DE PRODUCTOS ADICIONALES:
                    - Descomente o agregue más opciones aquí según sea necesario.
                    - <option value="Yogurt griego artesanal 500 g">Yogurt griego artesanal 500 g</option>
                    - <option value="Yogurt griego artesanal 250 g">Yogurt griego artesanal 250 g</option>
                    - <option value="Yogurt griego saborizado (Frutos Rojos) 1 Kg">Yogurt griego saborizado (Frutos Rojos) 1 Kg</option>
                    ----------------------------------------------------------------------
                    -->
                </select>
            </div>

            <div class="form-group">
                <label for="cantidad">Cantidad</label>
                <input type="number" id="cantidad" name="Cantidad" min="1" value="1" required>
            </div>

            <div id="totalPrice" class="total-price"></div>

            <button type="submit" id="submitButton" class="submit-btn">Enviar pedido</button>
        </form>

        <div id="statusMessage" class="status-message"></div>

        <p class="form-note">Por favor, haga su pedido con al menos 3 días de anticipación, para que pueda disfrutar de la frescura del verdadero Yogurt Griego Artesanal.</p>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- REFERENCIAS A ELEMENTOS DEL DOM ---
            const form = document.getElementById('orderForm');
            const cantidadInput = document.getElementById('cantidad');
            const totalPriceDiv = document.getElementById('totalPrice');
            const submitButton = document.getElementById('submitButton');
            const statusMessageDiv = document.getElementById('statusMessage');

            // --- CONSTANTES Y CONFIGURACIÓN ---
            const PRECIO_UNITARIO = 17000;
            
            /*
            ----------------------------------------------------------------------
            INSTRUCCIÓN DE INTEGRACIÓN (PASO 1 de 3): GOOGLE APPS SCRIPT URL
            - Cree un nuevo Google Apps Script (script.google.com).
            - Pegue el código de la función `doPost(e)` que se encuentra más abajo en los comentarios.
            - Implemente el script como "Aplicación web".
            - Configure el acceso para que "Cualquier persona" pueda ejecutarlo.
            - Copie la URL de la aplicación web y péguela aquí abajo.
            ----------------------------------------------------------------------
            */
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwkwm4vJhn90184_coT_GjwWkbdEtN31FzsWyZkfxtun9dPlgnTqX3vX3DHCbsJxtc-bg/exec';

            // --- FUNCIÓN PARA CALCULAR Y MOSTRAR EL PRECIO TOTAL ---
            function calcularPrecioTotal() {
                const cantidad = parseInt(cantidadInput.value) || 0;
                const total = cantidad * PRECIO_UNITARIO;
                
                const formatoMoneda = (numero) => {
                    return new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 }).format(numero);
                };

                totalPriceDiv.innerHTML = `Precio Total <span class="amount">${formatoMoneda(total)}</span>`;
                // Animar el cambio de precio
                totalPriceDiv.style.animation = 'none';
                void totalPriceDiv.offsetWidth; // Trigger reflow
                totalPriceDiv.style.animation = 'totalPulse 0.5s ease-out';
            }

            // --- EVENT LISTENERS ---
            cantidadInput.addEventListener('input', calcularPrecioTotal);
            
            form.addEventListener('submit', function (event) {
                event.preventDefault();

                if (GOOGLE_SCRIPT_URL === 'URL_DE_SU_GOOGLE_APPS_SCRIPT_AQUÍ' || !GOOGLE_SCRIPT_URL) {
                    mostrarMensaje('Error de configuración: La URL de Google Apps Script no ha sido establecida en el código HTML.', 'error');
                    return;
                }
                
                // Deshabilitar botón y mostrar estado de carga
                submitButton.disabled = true;
                submitButton.innerHTML = `<span class="loading"><span class="spinner"></span>Enviando...</span>`;
                statusMessageDiv.style.display = 'none';

                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: new FormData(form)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success') {
                        mostrarMensaje('¡Pedido enviado con éxito! Gracias por su compra.', 'success');
                        form.reset();
                        calcularPrecioTotal();
                    } else {
                        throw new Error(data.message || 'Ocurrió un error desconocido al procesar el pedido.');
                    }
                })
                .catch(error => {
                    console.error('Error al enviar el formulario:', error);
                    mostrarMensaje(`Error al enviar el pedido: ${error.message}`, 'error');
                })
                .finally(() => {
                    // Volver a habilitar el botón
                    submitButton.disabled = false;
                    submitButton.innerHTML = 'Enviar pedido';
                });
            });

            // --- FUNCIÓN PARA MOSTRAR MENSAJES DE ESTADO ---
            function mostrarMensaje(mensaje, tipo) {
                statusMessageDiv.textContent = mensaje;
                statusMessageDiv.className = `status-message ${tipo} show`;
            }

            // --- INICIALIZACIÓN ---
            calcularPrecioTotal();
        });

        /*
        ----------------------------------------------------------------------------------------------------
        INSTRUCCIÓN DE INTEGRACIÓN (PASO 2 de 3): CÓDIGO PARA GOOGLE APPS SCRIPT
        - Copie TODO el código que está debajo de esta línea y péguelo en su proyecto de Google Apps Script.
        - Configure las variables en la sección "CONFIGURACIÓN".
        ----------------------------------------------------------------------------------------------------
        
        function doPost(e) {
          // --- CONFIGURACIÓN ---
          // 1. ID de su Hoja de Cálculo de Google (lo encuentra en la URL de la hoja)
          const SPREADSHEET_ID = "ID_DE_SU_HOJA_DE_CALCULO";
          // 2. Nombre de la hoja (pestaña) donde se guardarán los datos
          const SHEET_NAME = "Pedidos";
          // 3. Número de WhatsApp del Chef Leo (formato internacional, sin '+' ni espacios)
          const CHEF_LEO_WHATSAPP = "573001234567"; // Ejemplo para Colombia
          
          try {
            // Abrir la hoja de cálculo y la hoja específica
            const spreadsheet = SpreadsheetApp.openById(SPREADSHEET_ID);
            const sheet = spreadsheet.getSheetByName(SHEET_NAME);
            
            // Obtener datos del formulario
            const data = e.parameter;
            const timestamp = new Date();
            const nombre = data.Nombre;
            const telefono = data.Telefono;
            const producto = data.Producto;
            const cantidad = data.Cantidad;
            const precioTotal = parseInt(cantidad, 10) * 17000;

            // Añadir una nueva fila con los datos del pedido
            sheet.appendRow([timestamp, nombre, telefono, producto, cantidad, precioTotal]);
            
            // Enviar notificación por WhatsApp
            sendWhatsAppNotification(nombre, telefono, producto, cantidad, precioTotal, CHEF_LEO_WHATSAPP);

            // Devolver una respuesta de éxito al formulario HTML
            return ContentService
              .createTextOutput(JSON.stringify({ result: 'success', message: 'Pedido registrado' }))
              .setMimeType(ContentService.MimeType.JSON);

          } catch (error) {
            // Registrar el error para depuración
            Logger.log(error.toString());
            
            // Devolver una respuesta de error al formulario HTML
            return ContentService
              .createTextOutput(JSON.stringify({ result: 'error', message: error.toString() }))
              .setMimeType(ContentService.MimeType.JSON);
          }
        }

        /*
        ----------------------------------------------------------------------------------------------------
        INSTRUCCIÓN DE INTEGRACIÓN (PASO 3 de 3): FUNCIÓN DE NOTIFICACIÓN POR WHATSAPP
        - Esta función es llamada por `doPost(e)`.
        - Requiere una cuenta en un proveedor de API de WhatsApp Business (ej: Twilio, Meta for Developers, etc.).
        - Configure las credenciales de su proveedor de API en la sección "CONFIGURACIÓN DE WHATSAPP API".
        ----------------------------------------------------------------------------------------------------
        
        function sendWhatsAppNotification(nombre, telefono, producto, cantidad, precioTotal, destinationNumber) {
          // --- CONFIGURACIÓN DE WHATSAPP API ---
          // Reemplace estos valores con los de su proveedor de API de WhatsApp
          const WHATSAPP_API_URL = "URL_DEL_ENDPOINT_DE_SU_PROVEEDOR_API"; // Ej: URL de la API de Twilio
          const AUTH_TOKEN = "SU_TOKEN_DE_AUTENTICACION"; // Ej: Account SID y Auth Token de Twilio combinados o Bearer Token

          // Construir el mensaje
          const mensaje = `*¡Nuevo Pedido LeoGriego!* 🍲

        *Cliente:* ${nombre}
        *Teléfono:* ${telefono}
        *Producto:* ${producto}
        *Cantidad:* ${cantidad}
        *Total:* $${precioTotal.toLocaleString('es-CO')} COP

        Pedido recibido el ${new Date().toLocaleString('es-CO')}.`;

          // Configurar la petición HTTP
          const payload = {
            // La estructura del payload depende de su proveedor de API.
            // Este es un ejemplo genérico. Consulte la documentación de su proveedor.
            to: `whatsapp:${destinationNumber}`,
            from: 'whatsapp:NUMERO_DE_WHATSAPP_DE_SU_EMPRESA', // Su número de WhatsApp Business
            body: mensaje
          };
          
          const options = {
            'method': 'post',
            'contentType': 'application/json',
            'headers': {
              'Authorization': `Bearer ${AUTH_TOKEN}` // O 'Basic ' + Base64.encode(user:pass) para Twilio
            },
            'payload': JSON.stringify(payload),
            'muteHttpExceptions': true // Para poder capturar errores
          };

          try {
            // Enviar la petición
            const response = UrlFetchApp.fetch(WHATSAPP_API_URL, options);
            Logger.log(`Respuesta de la API de WhatsApp: ${response.getContentText()}`);
          } catch(error) {
            Logger.log(`Error al enviar notificación de WhatsApp: ${error.toString()}`);
          }
        }
        */

    </script>
</body>
</html>
